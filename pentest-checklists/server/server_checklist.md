Server Security Penetration Testing Checklist
This checklist provides a comprehensive guide for conducting penetration testing on servers hosting Learning Management Systems (LMS) or Loan Origination Systems (LOS) applications.
It covers advanced vulnerabilities, including privilege escalation, kernel exploits, and log tampering, with obfuscation techniques to bypass security controls. 
The checklist aligns with CIS Benchmarks, OWASP, and NIST SP 800-115, ensuring robust server security.

1. Information Gathering
Objective
Collect server information to identify potential attack vectors and misconfigurations.

Enumerate Server Details

Identify OS type and version using Nmap (e.g., nmap -O <target>).
Check for exposed services (e.g., SSH, FTP) using nmap -sV <target>.
Gather kernel version via uname -r or error messages.
Identify server software (e.g., Apache, Nginx) and versions via HTTP headers.


Network Reconnaissance

Perform port scanning to identify open ports (e.g., nmap -p- <target>).
Check for exposed management interfaces (e.g., /phpmyadmin, /webmin).
Use OSINT tools (e.g., Shodan) to find server exposure.


File System Enumeration

Identify world-readable files (e.g., /etc/passwd) using find / -perm -o=r.
Check for exposed configuration files (e.g., /etc/nginx/nginx.conf).
Test for backup files (e.g., .bak, .old) in web directories.



2. Configuration Testing
Objective
Identify misconfigurations that could expose the server to attacks.

Test OS Configuration

Verify OS hardening (e.g., CIS Benchmarks for Ubuntu/CentOS).
Check for unnecessary services running (e.g., systemctl list-units).
Test for default or weak credentials on system accounts (e.g., root, admin).
Ensure kernel parameters are secure (e.g., sysctl -a | grep net.ipv4).


Test Service Configuration

Verify secure SSH settings (e.g., disable root login, use key-based auth in secure_ssh_config).
Check for secure web server configurations (e.g., nginx_secure.conf).
Test for exposed database services (e.g., MySQL on port 3306).
Ensure only required ports are open (e.g., iptables -L or ufw status).


Test File Permissions

Verify restrictive permissions on sensitive files (e.g., chmod 600 /etc/shadow).
Test for writable directories in /var/www or /tmp using find / -perm -o=w.
Check for misconfigured .htaccess or equivalent files.


Test Logging Configuration

Ensure security events are logged (e.g., /var/log/auth.log).
Verify logs are protected from tampering (e.g., read-only permissions).
Test for sensitive data in logs (e.g., API keys, passwords).



3. Access Control Testing
Objective
Prevent unauthorized access to server resources.

Test User Privileges

Check for excessive user permissions using getfacl or ls -l.
Test for weak sudo configurations (e.g., sudo -l for misconfigured commands).
Verify no unnecessary users or groups (e.g., cat /etc/passwd).


Test Service Access

Ensure services run with least privilege (e.g., non-root user for Nginx).
Test for anonymous FTP or SMB access (e.g., ftp <target>).
Check for unrestricted access to management interfaces (e.g., SSH, RDP).


Test Network Access Controls

Verify firewall rules restrict inbound/outbound traffic (e.g., iptables_rules.conf).
Test for open ports accessible externally using Nmap.
Check for IP whitelisting or blacklisting misconfigurations.



4. Vulnerability Testing
Objective
Identify exploitable vulnerabilities in the server environment.

Test for Known Vulnerabilities

Scan for CVEs using Nessus or OpenVAS (e.g., openvas <target>).
Check for outdated software versions (e.g., apt list --installed).
Test for kernel exploits (e.g., Dirty COW, CVE-2021-4034) using privilege_escalation.sh.


Test for Privilege Escalation

Attempt privilege escalation via misconfigured sudoers (e.g., sudo -l).
Test writable cron jobs or scripts (e.g., find /etc/cron* -perm -o=w).
Check for exploitable SUID/SGID binaries (e.g., find / -perm -4000).
Use obfuscation (e.g., encoded commands, LD_PRELOAD manipulation).


Test for Service Exploits

Test SSH for brute-force or key-based auth bypass (e.g., hydra -l root -P wordlist.txt ssh://<target>).
Check for web server exploits (e.g., Apache Struts vulnerabilities).
Test for RCE in exposed services (e.g., Redis, Memcached).


Test for Deserialization Vulnerabilities

Identify services using serialized objects (e.g., PHP, Java).
Test for insecure deserialization using ysoserial (e.g., ysoserial.jar CommonsCollections4 <command>).
Attempt RCE or data tampering via crafted serialized objects.



5. Network Security Testing
Objective
Secure network communications and prevent unauthorized access.

Test TLS/SSL Configurations

Verify TLS 1.2+ usage with no weak ciphers (e.g., tls_check.sh).
Test for DROWN, POODLE, BEAST, FREAK, or LOGJAM vulnerabilities using SSLyze.
Ensure certificates use â‰¥2048-bit keys and SHA-256 (no MD5/SHA-1).


Test for Server-Side Request Forgery (SSRF)

Check for SSRF in server-side scripts accessing internal resources (e.g., http://localhost:8080).
Test with obfuscated URLs (e.g., decimal IP, 127.0.0.1.nip.io).
Attempt access to internal metadata (e.g., /proc/self).


Test for DNS Misconfigurations

Check for DNS zone transfers (e.g., dig axfr @ns.target.com).
Test for dangling DNS records or subdomain takeover.



6. Log and Monitoring Testing
Objective
Ensure logs are secure, tamper-proof, and compliant with LMS/LOS requirements.

Test Log Integrity

Attempt log tampering via input fields or command injection (e.g., ; echo malicious >> /var/log/auth.log).
Verify logs are stored with read-only permissions (e.g., chmod 640 /var/log/*).
Check for log rotation and retention policies (e.g., FERPA/GLBA compliance).


Test Log Content

Ensure no sensitive data (e.g., passwords, API keys) in logs.
Verify logging of critical events (e.g., login failures, privilege changes).
Test for log poisoning (e.g., injecting fake entries via HTTP headers).


Test Monitoring

Check for real-time monitoring of security events (e.g., IDS/IPS integration).
Test for alerting on suspicious activities (e.g., multiple failed logins).



7. Backup and Recovery Testing
Objective
Secure backup processes and prevent unauthorized access to backups.

Test Backup Access

Check for exposed backup files (e.g., /backup.tar.gz) in web directories.
Verify backups are encrypted and stored off-site or with restricted access.
Test for predictable backup filenames (e.g., backup-2025-06-20.sql).


Test Backup Restoration

Ensure restoration processes require authentication and authorization.
Test for data integrity during restoration (e.g., no tampering).



8. Obfuscation Techniques
Objective
Test server defenses against obfuscated inputs that may bypass security controls.

Encoding Techniques

Use Base64, URL, ASCII, Hex, Binary, Octal, or Gzip encoding for payloads.
Apply double encoding (e.g., %252e%252e%252f) or null bytes (%00).
Test with Unicode or malformed inputs (e.g., ../%EF%BC%8Fetc/passwd).


Command Obfuscation

Obfuscate commands (e.g., $(whoami), w${h}oami) to bypass filters.
Use environment variable manipulation (e.g., LD_PRELOAD for privilege escalation).
Test with nested or chained commands (e.g., cat /etc/passwd | base64).


Network Obfuscation

Use encoded IPs (e.g., decimal 2130706433 for 127.0.0.1) for SSRF.
Test with malformed headers or protocols (e.g., gopher://).



9. Tools

Reconnaissance: Nmap, Shodan, Netcat
Vulnerability Scanning: Nessus, OpenVAS, Lynis
Privilege Escalation: privilege_escalation.sh, LinPEAS, WinPEAS
TLS Testing: SSLyze, testssl.sh
Log Analysis: LogParser, Splunk
Deserialization Testing: ysoserial



11. References

CIS Benchmarks (Ubuntu, CentOS, Nginx)
OWASP Testing Guide
NIST SP 800-115
SecLists for payloads and wordlists
MITRE ATT&CK for server attack techniques

